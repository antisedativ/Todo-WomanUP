<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/todo/Todo.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/todo/Todo.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, {useContext, useEffect, useState} from 'react';
import cl from './Todo.module.scss'
import {getDownloadURL, ref} from "firebase/storage";
import {Context} from "../../index";
import DeleteForeverIcon from '@mui/icons-material/DeleteForever';
import EditIcon from '@mui/icons-material/Edit';
import DoneOutlinedIcon from '@mui/icons-material/DoneOutlined';
import DoneAllOutlinedIcon from '@mui/icons-material/DoneAllOutlined';
import {Link} from "react-router-dom";
import {doc, deleteDoc, updateDoc} from "firebase/firestore";
import Timer from "../Timer";

/**
 * Функция, которая принимает время формата UNIX и возвращает формат ММ:СС
 * @param {number} unix_timestamp - Время в формате UNIX
 * @returns {string} - Время в формате ММ:СС
 */
const formattedTime = (unix_timestamp) => {
    let date = new Date(unix_timestamp * 1000);
    let hours = date.getHours();
    let minutes = "0" + date.getMinutes();
    return hours + ':' + minutes.substr(-2);
}

/**
 * Реакт компонент самого поста
 * @param {object} todo - Данные поста
 * @param {number} index - Индекс
 * @returns {JSX.Element}
 * @constructor
 */
const Todo = ({todo, index}) => {

    const [url, setUrl] = useState('')

    // Получение данных из контекста
    const {storage, db} = useContext(Context)

    const docRef = doc(db, "data", todo.key);

    useEffect(() => {
        getDownloadURL(ref(storage, `img/${todo.fileName}`))
            .then((url) => {
                setUrl(url)
            });
    }, [todo.complete])

    /**
     * Функция, которая позволяет отметить пост как "выполненный"
     * @returns {Promise&lt;void>}
     * @example
     * async function completeTodo () {
     *         await updateDoc(docRef, {complete: !todo.complete});
     *     }
     */
    async function completeTodo () {
        await updateDoc(docRef, {complete: !todo.complete});
    }

    /**
     * Функция, которая позволяет удалять пост
     * @returns {Promise&lt;void>}
     * @example
     * async function deleteTodo () {
     *         const newTodo = {
     *             title: '',
     *             description: '',
     *             dateCompletion: '',
     *             complete: false,
     *             createdAt: 0,
     *             fileName: ''
     *         };
     *
     *         await deleteDoc(docRef);
     *         await updateDoc(docRef, newTodo);
     *     }
     */
    async function deleteTodo () {
        const newTodo = {
            title: '',
            description: '',
            dateCompletion: '',
            complete: false,
            createdAt: 0,
            fileName: ''
        };

        await deleteDoc(docRef);
        await updateDoc(docRef, newTodo);
    }

    return (
        &lt;div className={cl.wrapper}>
                {
                    todo.complete ? &lt;div style={{margin: 'auto'}}>
                            &lt;DoneAllOutlinedIcon sx={{ fontSize: 70 }} style={{cursor:"pointer"}} onClick={completeTodo}/>
                        &lt;/div>
                        : &lt;>
                            &lt;div className={cl.body}>
                                &lt;div className={cl.title}>
                                    &lt;div>
                                        &lt;span className={cl.id}>{index}.&lt;/span>
                                        {todo.title}
                                    &lt;/div>
                                    &lt;div className={cl.created_data}>Update time:
                                        &lt;span style={{color: "blueviolet", marginLeft: 5}}>
                                            {formattedTime(todo.createdAt.seconds)}
                                        &lt;/span>
                                    &lt;/div>
                                &lt;/div>
                                &lt;div className={cl.desc}>
                                    {todo.description}
                                &lt;/div>
                                &lt;div className={cl.icons}>
                                    &lt;DeleteForeverIcon sx={{ fontSize: 30 }} onClick={deleteTodo}/>
                                    &lt;Link to={`/todo/${todo.id}/`}>&lt;EditIcon sx={{ fontSize: 30 }} />&lt;/Link>
                                    &lt;DoneOutlinedIcon onClick={completeTodo}/>
                                    &lt;div className={cl.time_to_end}>
                                        Time to end:
                                        &lt;span style={{color: "blueviolet", marginLeft: 10}}>
                                            &lt;Timer time={todo.dateCompletion} docRef={docRef} complete={todo.complete}/>
                                        &lt;/span>
                                    &lt;/div>
                                &lt;/div>
                            &lt;/div>
                            &lt;div className={cl.img}>
                                {url &amp;&amp; &lt;img src={url} alt="Another file"/>}
                            &lt;/div>
                        &lt;/>
                }
        &lt;/div>
    );
};

export default Todo;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="About.html">About</a></li><li><a href="AllTodo.html">AllTodo</a></li><li><a href="App.html">App</a></li><li><a href="CreateTodo.html">CreateTodo</a></li><li><a href="Header.html">Header</a></li><li><a href="Timer.html">Timer</a></li><li><a href="Todo.html">Todo</a></li><li><a href="TodoDetails.html">TodoDetails</a></li></ul><h3>Tutorials</h3><ul><li><a href="tutorial-install.html">install</a></li></ul><h3>Global</h3><ul><li><a href="global.html#formattedTime">formattedTime</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.0</a> on Sun Nov 20 2022 04:42:00 GMT+0300 (Москва, стандартное время)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
