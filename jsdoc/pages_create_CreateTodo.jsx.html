<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: pages/create/CreateTodo.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: pages/create/CreateTodo.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, {useContext, useState} from 'react';
import cl from "./CreateTodo.module.scss";
import {Context} from "../../index";
import { collection, Timestamp,doc, setDoc } from "firebase/firestore";
import { ref as storageRef , uploadBytes } from "firebase/storage";
import { v4 } from "uuid";

/**
 * Создание нового поста
 * Содержит форму с полями:
 * - Название
 * - Описание
 * - Время до конца выполнения
 * - Файл
 * @returns {JSX.Element}
 * @constructor
 */
function CreateTodo () {
    // Инициализация
    const [time, setTime] = useState('')
    const [title, setTitle] = useState("");
    const [description, setDescription] = useState("");
    const [image,setImage] = useState(null)
    const {db, storage} = useContext(Context)

    /**
     * Функция создания нового поста
     * @param {object} e - Ивент
     * @returns {Promise&lt;void>}
     * @example
     *    const addNewTodo = async (e) => {
     *         e.preventDefault()
     *
     *             // Добавление файла
     *             const imageName = image.name + v4()
     *             const imgRef = storageRef(storage, `img/${imageName}`);
     *             await uploadBytes(imgRef, image).then(() => {
     *                 alert("File uploaded");
     *             });
     *
     *             // Генерация ключа
     *             const key = v4()
     *
     *             const date = Timestamp.fromDate(new Date())
     *
     *             // Создание туду
     *             const newTodo = {
     *                 id: date.seconds,
     *                 key,
     *                 title,
     *                 dateCompletion: time,
     *                 description,
     *                 createdAt: date,
     *                 complete: false,
     *                 fileName: imageName
     *             };
     *
     *             // Добавление названия и описания
     *             await setDoc(doc(collection(db, "data"),key),newTodo)
     *
     *     };
     */
    const addNewTodo = async (e) => {
        e.preventDefault()
        if(title &amp;&amp; description &amp;&amp; image) {

            // Добавление файла
            const imageName = image.name + v4()
            const imgRef = storageRef(storage, `img/${imageName}`);
            await uploadBytes(imgRef, image).then(() => {
                alert("File uploaded");
            });

            // Генерация ключа
            const key = v4()

            const date = Timestamp.fromDate(new Date())

            // Создание туду
            const newTodo = {
                id: date.seconds,
                key,
                title,
                dateCompletion: time,
                description,
                createdAt: date,
                complete: false,
                fileName: imageName
            };

            // Добавление названия и описания
            await setDoc(doc(collection(db, "data"),key),newTodo)

            // Очистка полей
            setTime('')
            setTitle("");
            setDescription("");
        } else
            alert('Заполните все поля!')

    };

    return (
        &lt;div className={cl.body}>
            &lt;div className={cl.wrapper}>
                &lt;div> Create your todos&lt;/div>
                &lt;form>
                    &lt;input
                        type="text"
                        placeholder="Todo title"
                        value={title}
                        onChange={(e) => setTitle(e.target.value)}
                    />
                    &lt;input
                        type="text"
                        placeholder="Todo description"
                        value={description}
                        onChange={(e) => setDescription(e.target.value)}
                    />
                    &lt;input
                        type="time"
                        onChange={(e) => setTime(e.target.value)}
                    />
                    &lt;input
                        type="file"
                        onChange={e => setImage(e.target.files[0])}
                    />
                    &lt;button className={cl.btn} onClick={addNewTodo}>Create todos&lt;/button>
                &lt;/form>
            &lt;/div>
        &lt;/div>
    );
};

export default CreateTodo;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="About.html">About</a></li><li><a href="AllTodo.html">AllTodo</a></li><li><a href="App.html">App</a></li><li><a href="CreateTodo.html">CreateTodo</a></li><li><a href="Header.html">Header</a></li><li><a href="Timer.html">Timer</a></li><li><a href="Todo.html">Todo</a></li><li><a href="TodoDetails.html">TodoDetails</a></li></ul><h3>Tutorials</h3><ul><li><a href="tutorial-install.html">install</a></li></ul><h3>Global</h3><ul><li><a href="global.html#formattedTime">formattedTime</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.0</a> on Sun Nov 20 2022 05:34:24 GMT+0300 (Москва, стандартное время)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
